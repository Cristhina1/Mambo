<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MAMBO — Tienda Urbana (Oscuro)</title>

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Fuente moderna -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;900&display=swap" rel="stylesheet">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Alexandria:wght@100..900&family=Amiko:wght@400;600;700&display=swap');
    :root {
      --bg: #000000;
      --panel: #000000;
      --muted: #9aa0a6;
      --accent: #f5c518;
      /* dorado */
      --white: #ffffff;
      --glass: rgba(255, 255, 255, 0.03);
      --card-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
    }

    html,
    body {
      height: 100%;
    }

    body {
      margin: 0;
      background: linear-gradient(180deg, #050506 0%, #0b0b0d 100%);
      color: var(--white);
      font-family: 'Alexandria', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* ---------- NAVBAR ---------- */
    .navbar {
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.01), rgba(255, 255, 255, 0.02));
      border-bottom: 1px solid rgba(255, 255, 255, 0.04);
      padding-bottom: .3rem;
    }

    .navbar-brand {
      color: var(--accent);
      font-weight: 900;
      letter-spacing: 1px;
      font-size: 1.25rem;
    }

    .nav-link {
      color: var(--muted) !important;
      font-weight: 600;
      text-transform: uppercase;
      font-size: .85rem;
    }

    .nav-link:hover {
      color: var(--accent) !important;
    }

    .btn-outline-accent {
      color: var(--accent);
      border-color: rgba(245, 197, 24, 0.22);
      background: transparent;
      font-weight: 700;
    }

    .btn-outline-accent:hover {
      background: var(--accent);
      color: #050506;
    }

    /* ---------- HEADER BANNER ---------- */
    .hero {
      height: 220px;
      border-radius: 10px;
      background-image: url('https://images.unsplash.com/photo-1512436991641-6745cdb1723f');
      background-size: cover;
      background-position: center;
      margin: 1.25rem 0;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--card-shadow);
      position: relative;
      overflow: hidden;
    }

    .hero::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(5, 5, 6, 0.55), rgba(5, 5, 6, 0.85));
    }

    .hero h1 {
      position: relative;
      z-index: 1;
      margin: 0;
      font-size: 2rem;
      color: var(--white);
      letter-spacing: 3px;
      text-transform: uppercase;
      font-weight: 900;
    }

    /* ---------- LAYOUT ---------- */
    .site-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
    }

    .main-grid {
      display: grid;
      grid-template-columns: 260px 1fr;
      gap: 1.5rem;
      align-items: start;
    }

    @media (max-width: 992px) {
      .main-grid {
        grid-template-columns: 1fr;
      }
    }

    /* ---------- SIDEBAR / FILTER ---------- */
    .sidebar {
      background: linear-gradient(180deg, var(--panel), rgba(255, 255, 255, 0.01));
      border: 1px solid rgba(255, 255, 255, 0.03);
      padding: 1.25rem;
      border-radius: 12px;

      top: 86px;
      height: fit-content;
    }

    @media (min-width: 990px) {
      .sidebar {
        position: sticky;
      }
    }

    .sidebar h5 {
      color: var(--accent);
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: .75rem;
    }

    .sidebar label {
      color: var(--muted);
      font-size: .9rem;
    }

    .category-btn {
      display: block;
      width: 100%;
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.03);
      color: var(--white);
      text-align: left;
      padding: .6rem .75rem;
      margin-bottom: .5rem;
      border-radius: 8px;
      transition: all .18s ease;
      font-weight: 600;
    }

    .category-btn:hover {
      background: rgba(245, 197, 24, 0.12);
      color: var(--accent);
      transform: translateY(-3px);
    }

    .price-range {
      display: flex;
      gap: .5rem;
      margin-top: .5rem;
    }

    .price-range input {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.05);
      color: var(--white);
      padding: .45rem;
      border-radius: 8px;
      width: 100%;
    }

    /* ---------- CATALOG HEADER ---------- */
    .catalog-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.04);
      padding-bottom: .6rem;
    }

    .catalog-title {
      text-transform: uppercase;
      letter-spacing: 2px;
      font-weight: 800;
      color: var(--white);
    }

    .search-box {
      display: flex;
      align-items: center;
      gap: .25rem;
      background: var(--glass);
      border: 1px solid rgba(255, 255, 255, 0.03);
      padding: .35rem;
      border-radius: 10px;
    }

    .search-box input {
      background: transparent;
      border: 0;
      color: var(--white);
      outline: none;
      padding: .4rem .6rem;
      min-width: 180px;
    }

    .search-box button {
      background: var(--accent);
      border: 0;
      color: #050506;
      padding: .45rem .6rem;
      border-radius: 8px;
      font-weight: 800;
    }

    /* ---------- PRODUCT GRID & CARD ---------- */
    .products-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1.25rem;
    }

    @media (max-width:1200px) {
      .products-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (max-width:900px) {
      .products-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width:576px) {
      .products-grid {
        grid-template-columns: 1fr;
      }
    }

    .card-product {
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.01), rgba(255, 255, 255, 0.02));
      border: 1px solid rgba(255, 255, 255, 0.03);
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
      transition: transform .28s cubic-bezier(.2, .9, .2, 1), box-shadow .28s;
      display: flex;
      flex-direction: column;
      min-height: 420px;
    }

    .card-product:hover {
      transform: translateY(-8px);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
      border-color: rgba(245, 197, 24, 0.18);
    }

    .card-product .media {
      height: 260px;
      background: #0b0b0c;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .card-product .media img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform .45s ease;
    }

    .card-product:hover .media img {
      transform: scale(1.06);
    }

    .card-product .body {
      padding: 1rem 1rem;
      display: flex;
      flex-direction: column;
      gap: .5rem;
      flex: 1;
    }

    .product-title {
      font-weight: 800;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: .6px;
    }

    .product-sub {
      color: var(--muted);
      font-size: .9rem;
      margin-top: -.2rem;
    }

    .price-row {
      margin-top: auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: .5rem;
    }

    .price {
      font-weight: 900;
      color: var(--white);
    }

    .add-btn {
      background: linear-gradient(180deg, var(--accent), #e6b300);
      border: 0;
      color: #050506;
      padding: .5rem .9rem;
      border-radius: 10px;
      font-weight: 800;
      transition: transform .12s;
    }

    .add-btn:active {
      transform: translateY(1px);
    }

    /* ---------- CATEGORY CHIPS (debajo catálogo) ---------- */
    .chips {
      display: flex;
      gap: .5rem;
      flex-wrap: wrap;
      margin-top: 1.25rem;
    }

    .chip {
      padding: .45rem .8rem;
      border-radius: 999px;
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.03);
      color: var(--white);
      font-weight: 600;
    }

    .chip:hover {
      background: rgba(245, 197, 24, 0.12);
      color: var(--accent);
      cursor: pointer;
      transform: translateY(-3px);
    }

    /* ---------- OFFCANVAS / CART ---------- */
    .offcanvas {
      background: #050506;
      color: var(--white);
      border-left: 2px solid rgba(245, 197, 24, 0.25);
    }

    .offcanvas .offcanvas-header {
      border-bottom: 1px solid rgba(255, 255, 255, 0.03);
    }

    .cart-item {
      display: flex;
      gap: .75rem;
      align-items: center;
      padding: .85rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.03);
    }

    .cart-item img {
      width: 74px;
      height: 74px;
      object-fit: cover;
      border-radius: 8px;
    }

    .cart-info h6 {
      margin: 0;
      font-weight: 800;
      font-size: .95rem;
    }

    .cart-info p {
      margin: 0;
      color: var(--muted);
      font-size: .9rem;
    }

    .qty-control {
      display: flex;
      gap: .4rem;
      align-items: center;
      margin-top: .45rem;
    }

    .qty-control button {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.04);
      color: var(--white);
      padding: .25rem .5rem;
      border-radius: 6px;
    }

    .subtotal {
      font-weight: 900;
      color: var(--white);
    }

    .remove-btn {
      background: #ff3b3b;
      border: 0;
      color: #fff;
      padding: .35rem .6rem;
      border-radius: 8px;
      font-weight: 700;
    }

    /* ---------- FOOTER ---------- */
    footer {
      margin-top: 2.25rem;
      padding: 2rem 0;
      border-top: 1px solid rgba(255, 255, 255, 0.03);
      color: var(--muted);
    }

    footer h6 {
      color: var(--accent);
      font-weight: 900;
      margin-bottom: .5rem;
    }

    /* small niceties */
    .muted {
      color: var(--muted);
      font-size: .9rem;
    }

    .badge-accent {
      background: var(--accent);
      color: #050506;
      font-weight: 900;
      border-radius: 999px;
      padding: .25rem .55rem;
    }
  </style>
</head>

<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg">
    <div class="container site-container">
      <a class="navbar-brand text-white" href="#">MAMBO</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse justify-content-end" id="navMain">
        <ul class="navbar-nav align-items-center">
          <li class="nav-item"><a class="nav-link" th:href=@{/}>Home</a></li>
          <li class="nav-item"><a class="nav-link" th:href=@{/client/listadeproductos}>Productos</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Contáctanos</a></li>
          <li class="nav-item"><a class="nav-link" th:href=@{/login}><i
                class="bi bi-person"></i> Iniciar</a></li>
          <li class="nav-item ms-2">
            <button class="btn btn-dark position-relative" data-bs-toggle="offcanvas" data-bs-target="#cartCanvas"
              aria-controls="cartCanvas">
              <i class="bi bi-cart3 fs-5"></i>
              <span id="cartBadge" class="badge-accent position-absolute top-0 start-100 translate-middle">0</span>
            </button>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- SITE CONTENT -->
  <div class="site-container">
    <div class="hero" role="banner" aria-label="Banner principal">
      <h1>Encuentra tu estilo</h1>
    </div>

    <!-- MAIN GRID -->
    <div class="main-grid">

      <!-- SIDEBAR FILTER -->
      <aside class="sidebar d-none d-md-block" aria-label="Filtros">
        <h5>Filtrar</h5>

        <label class="muted">Categorías</label>
        <button class="category-btn" data-cat="Poleras">Poleras</button>
        <button class="category-btn" data-cat="Chaquetas">Chaquetas</button>
        <button class="category-btn" data-cat="Pantalones">Pantalones</button>
        <button class="category-btn" data-cat="Shorts">Shorts</button>
        <button class="category-btn" data-cat="Accesorios">Accesorios</button>
        <button class="category-btn" data-cat="Ofertas">Ofertas</button>

        <hr style="border-color: rgba(255,255,255,0.03)">

        <label class="muted">Precio (S/)</label>
        <div class="price-range">
          <input id="minPrice" type="number" placeholder="Mín" min="0">
          <input id="maxPrice" type="number" placeholder="Máx" min="0">
        </div>

        <div style="margin-top:10px;">
          <button id="applyFilter" class="category-btn"
            style="background:var(--accent); color:#050506;">Aplicar</button>
          <button id="clearFilter" class="category-btn" style="margin-top:6px;">Limpiar filtros</button>
        </div>

      </aside>

      <!-- CATALOG + PRODUCTS -->
      <section class="catalogo">

        <!-- top (title + search) -->
        <div class="catalog-top">
          <div class="catalog-title">Catálogo</div>

          <div class="search-box" role="search" aria-label="Buscar productos">
            <input id="searchInput" placeholder="Buscar por nombre..." />
            <button id="searchBtn" title="Buscar"><i class="bi bi-search"></i></button>
          </div>
        </div>
        <button class="btn btn-outline-warning d-md-none mb-3" data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasFiltro">
          <i class="bi bi-funnel"></i> Filtros
        </button>
        <div class="offcanvas offcanvas-start bg-dark text-white d-block d-md-none" tabindex="-1" id="offcanvasFiltro">
          <div class="offcanvas-header border-bottom border-secondary">
            <h5 class="offcanvas-title text-uppercase text-warning">Filtrado</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
          </div>
          <div class="offcanvas-body">
            <label class="muted">Categorías</label>
            <button class="category-btn" data-cat="Poleras">Poleras</button>
            <button class="category-btn" data-cat="Chaquetas">Chaquetas</button>
            <button class="category-btn" data-cat="Pantalones">Pantalones</button>
            <button class="category-btn" data-cat="Shorts">Shorts</button>
            <button class="category-btn" data-cat="Accesorios">Accesorios</button>
            <button class="category-btn" data-cat="Ofertas">Ofertas</button>

            <hr style="border-color: rgba(255,255,255,0.03)">

            <label class="muted">Precio (S/)</label>
            <div class="price-range">
              <input id="minPrice" type="number" placeholder="Mín" min="0">
              <input id="maxPrice" type="number" placeholder="Máx" min="0">
            </div>

            <div style="margin-top:10px;">
              <button id="applyFilter" class="category-btn"
                style="background:var(--accent); color:#050506;">Aplicar</button>
              <button id="clearFilter" class="category-btn" style="margin-top:6px;">Limpiar filtros</button>
            </div>
          </div>
        </div>

        <!-- PRODUCT GRID -->
        <div id="productsGrid" class="products-grid" aria-live="polite">
          <article class="card-product">
            <div class="media"><img src="image" alt="image"></div>
            <div class="body">
              <div>
                <div class="product-title">Overside</div>
                <div class="product-sub muted">Categoria: Polo</div>
                <div class="product-sub muted">Stock: 10</div>
              </div>
              <div class="price-row">
                <div class="price">S/ 1000.00</div>
                <button class="add-btn" data-id="${p.id}">Agregar</button>
              </div>
            </div>
          </article>

          <!-- Cards se insertan por JS -->
           <!--Lo demas esta en carrito-->
        </div>
        <hr class="mx-2 mt-5">
        <h4>CATEGORIAS A ELEGIR</h4>
        <!-- categories chips debajo -->
        <div class="chips" aria-hidden="false">
          <div class="chip" data-cat="Poleras">Poleras</div>
          <div class="chip" data-cat="Chaquetas">Chaquetas</div>
          <div class="chip" data-cat="Pantalones">Pantalones</div>
          <div class="chip" data-cat="Accesorios">Accesorios</div>
          <div class="chip" data-cat="Ofertas">Ofertas</div>
        </div>

      </section>

    </div> <!-- main-grid -->
  </div> <!-- site-container -->

  <!-- OFFCANVAS CART -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="cartCanvas" aria-labelledby="cartLabel">
    <div class="offcanvas-header">
      <h5 id="cartLabel" class="offcanvas-title">Tu Carrito</h5>
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
    </div>
    <div class="offcanvas-body">
      <div id="cartItemsArea">
        <p class="muted">No hay productos en el carrito.</p>
      </div>

      <div class="mt-3 text-end">
        <div class="muted">Total</div>
        <div id="cartTotal" style="font-weight:900; font-size:1.15rem; margin-top:.25rem;">S/ 0.00</div>
        <button id="checkoutBtn" class="add-btn w-100 mt-3">Finalizar compra</button>
      </div>
    </div>
  </div>

  <!-- LOGIN MODAL -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" role="dialog" aria-modal="true">
        <div class="modal-header">
          <h5 class="modal-title">Iniciar sesión</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <form id="loginForm">
            <div class="mb-3">
              <label class="muted">Correo</label>
              <input required type="email" class="form-control bg-transparent border-1 text-white" />
            </div>
            <div class="mb-3">
              <label class="muted">Contraseña</label>
              <input required type="password" class="form-control bg-transparent border-1 text-white" />
            </div>
            <button class="add-btn w-100" type="submit">Entrar</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <div class="site-container">
      <div class="row">
        <div class="col-md-6 mb-3">
          <h6>Ubicación</h6>
          <p class="muted">Multicentro - Santa Clara - Ate<br>Tiendas N°05-393</p>
          <a href="https://www.google.com/maps?q=Multicentro+Santa+Clara+Ate" target="_blank" rel="noopener"
            class="muted">Ver en Google Maps →</a>
        </div>
        <div class="col-md-6">
          <h6>Contacto</h6>
          <p class="muted"><i class="bi bi-telephone"></i> +51 923123890<br><i class="bi bi-envelope"></i>
            MamboClothing@gmail.com</p>
          <div style="margin-top:.5rem;">
            <a class="muted me-3" href="#"><i class="bi bi-facebook fs-4"></i></a>
            <a class="muted me-3" href="#"><i class="bi bi-instagram fs-4"></i></a>
            <a class="muted" href="#"><i class="bi bi-tiktok fs-4"></i></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    /********* Data de ejemplo de productos *********/
    const PRODUCTS = [
      { id: 'p1', name: 'Gorra Street', price: 100, img: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab', category: 'Accesorios' },
      { id: 'p2', name: 'Polera Oversize', price: 120, img: 'https://images.unsplash.com/photo-1512436991641-6745cdb1723f', category: 'Poleras' },
      { id: 'p3', name: 'Chaqueta Retro', price: 240, img: 'https://images.unsplash.com/photo-1602810318383-e7f6e7c2c479', category: 'Chaquetas' },
      { id: 'p4', name: 'Joggers Urban', price: 150, img: 'https://images.unsplash.com/photo-1520962922320-2038eebab146', category: 'Pantalones' },
      { id: 'p5', name: 'Sudadera Essentials', price: 180, img: 'https://images.unsplash.com/photo-1541099649105-f69ad21f3246', category: 'Chaquetas' },
      { id: 'p6', name: 'Shorts Street', price: 85, img: 'https://images.unsplash.com/photo-1541099649105-5b0a6f7b6f0b', category: 'Shorts' },
      { id: 'p7', name: 'Accesorio Classic', price: 45, img: 'https://images.unsplash.com/photo-1548365328-1c2f6f2f3c6a', category: 'Accesorios' },
      { id: 'p8', name: 'Pantalón Denim', price: 210, img: 'https://images.unsplash.com/photo-1540574163026-643ea20ade25', category: 'Pantalones' }
    ];

    /********* Estado del carrito (persistido) *********/
    let cart = JSON.parse(localStorage.getItem('mambo_cart_v1') || '[]');

    // Elementos UI
    const productsGrid = document.getElementById('productsGrid');
    const cartItemsArea = document.getElementById('cartItemsArea');
    const cartTotalEl = document.getElementById('cartTotal');
    const cartBadge = document.getElementById('cartBadge');

    /********* Render de productos *********/
    function renderProducts(list = PRODUCTS) {
      
      list.forEach(p => {
        const card = document.createElement('article');

        card.className = 'card-product';
        card.innerHTML = `
          <div class="media"><img src="${p.img}" alt="${p.name}"></div>
          <div class="body">
            <div>
              <div class="product-title">${p.name}</div>
              <div class="product-sub muted">Categoria: ${p.category}</div>
              <div class="product-sub muted">Stock: 10</div>
            </div>
            <div class="price-row">
              <div class="price">S/ ${p.price.toFixed(2)}</div>
              <button class="add-btn" data-id="${p.id}">Agregar</button>
            </div>
          </div>
        `;
        productsGrid.appendChild(card);
      });
      // añadir listeners botones agregar
      document.querySelectorAll('.add-btn').forEach(btn => btn.addEventListener('click', () => {
        const id = btn.dataset.id;
        const product = PRODUCTS.find(x => x.id === id);
        if (product) addToCart(product);
      }));
    }

    /********* Funciones carrito *********/
    function saveCart() { localStorage.setItem('mambo_cart_v1', JSON.stringify(cart)); }
    function getCartCount() { return cart.reduce((s, i) => s + i.qty, 0); }

    function addToCart(product) {
      const existing = cart.find(i => i.id === product.id);
      if (existing) existing.qty += 1;
      else cart.push({ id: product.id, name: product.name, price: product.price, img: product.img, qty: 1 });
      saveCart(); updateCartUI();
      // abrir offcanvas visual (opcional)
      const offcanvasEl = document.getElementById('cartCanvas');
      const bs = bootstrap.Offcanvas.getOrCreateInstance(offcanvasEl);
      bs.show();
    }

    function removeFromCart(id) {
      cart = cart.filter(i => i.id !== id);
      saveCart(); updateCartUI();
    }

    function changeQty(id, delta) {
      const it = cart.find(i => i.id === id);
      if (!it) return;
      it.qty += delta;
      if (it.qty < 1) it.qty = 1;
      saveCart(); updateCartUI();
    }

    function computeTotal() {
      return cart.reduce((s, i) => s + i.price * i.qty, 0);
    }

    function updateCartUI() {
      // badge
      const totalCount = getCartCount();
      cartBadge.textContent = totalCount;
      // items
      cartItemsArea.innerHTML = '';
      if (cart.length === 0) {
        cartItemsArea.innerHTML = '<p class="muted">No hay productos en el carrito.</p>';
      } else {
        cart.forEach(item => {
          const div = document.createElement('div');
          div.className = 'cart-item';
          div.innerHTML = `
            <img src="${item.img}" alt="${item.name}" />
            <div class="cart-info">
              <h6>${item.name}</h6>
              <p>Unit: S/ ${item.price.toFixed(2)}</p>
              <div class="qty-control">
                <button class="btn-decrease" data-id="${item.id}">−</button>
                <span style="min-width:24px;display:inline-block;text-align:center">${item.qty}</span>
                <button class="btn-increase" data-id="${item.id}">+</button>
              </div>
            </div>
            <div style="text-align:right;">
              <div class="subtotal">S/ ${(item.price * item.qty).toFixed(2)}</div>
              <div style="margin-top:.6rem;">
                <button class="remove-btn" data-id="${item.id}">Eliminar</button>
              </div>
            </div>
          `;
          cartItemsArea.appendChild(div);
        });

        // listeners
        cartItemsArea.querySelectorAll('.btn-decrease').forEach(b => b.addEventListener('click', e => {
          changeQty(e.currentTarget.dataset.id, -1);
        }));
        cartItemsArea.querySelectorAll('.btn-increase').forEach(b => b.addEventListener('click', e => {
          changeQty(e.currentTarget.dataset.id, +1);
        }));
        cartItemsArea.querySelectorAll('.remove-btn').forEach(b => b.addEventListener('click', e => {
          removeFromCart(e.currentTarget.dataset.id);
        }));
      }
      // total
      cartTotalEl.textContent = `S/ ${computeTotal().toFixed(2)}`;
    }

    /********* FILTRADO / BÚSQUEDA *********/
    function applyFilters() {
      const q = document.getElementById('searchInput').value.trim().toLowerCase();
      const minP = parseFloat(document.getElementById('minPrice').value) || 0;
      const maxP = parseFloat(document.getElementById('maxPrice').value) || Infinity;
      // categories selected by sidebar buttons? we detect active class
      const activeCatBtn = [...document.querySelectorAll('.category-btn')].find(b => b.classList.contains('active'));
      const cat = activeCatBtn ? activeCatBtn.dataset.cat : null;

      let list = PRODUCTS.filter(p => {
        const matchQ = !q || p.name.toLowerCase().includes(q);
        const matchP = (p.price >= minP && p.price <= maxP);
        const matchC = !cat || p.category === cat;
        return matchQ && matchP && matchC;
      });
      renderProducts(list);
    }

    function clearFilters() {
      document.getElementById('searchInput').value = '';
      document.getElementById('minPrice').value = '';
      document.getElementById('maxPrice').value = '';
      document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
      renderProducts(PRODUCTS);
    }

    /********* INIT *********/
    document.addEventListener('DOMContentLoaded', () => {
      renderProducts(PRODUCTS);
      updateCartUI();

      // sidebar category buttons (toggle active)
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          // toggle active marker
          const active = btn.classList.contains('active');
          document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
          if (!active) btn.classList.add('active');
          applyFilters();
        });
      });

      // chips below
      document.querySelectorAll('.chip').forEach(ch => {
        ch.addEventListener('click', () => {
          const cat = ch.dataset.cat;
          document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
          const target = [...document.querySelectorAll('.category-btn')].find(b => b.dataset.cat === cat);
          if (target) target.classList.add('active');
          applyFilters();
          // scroll to products
          window.scrollTo({ top: document.querySelector('.catalog-top').offsetTop - 60, behavior: 'smooth' });
        });
      });

      // search and price filter
      document.getElementById('searchBtn').addEventListener('click', applyFilters);
      document.getElementById('searchInput').addEventListener('keydown', e => { if (e.key === 'Enter') applyFilters(); });
      document.getElementById('applyFilter').addEventListener('click', applyFilters);
      document.getElementById('clearFilter').addEventListener('click', clearFilters);

      // checkout
      document.getElementById('checkoutBtn').addEventListener('click', () => {
        if (cart.length === 0) {
          alert('Tu carrito está vacío.');
          return;
        }
        alert('Simulación de compra — total: ' + computeTotal().toFixed(2));
      });

      // simple login handler (demo)
      document.getElementById('loginForm')?.addEventListener('submit', e => {
        e.preventDefault();
        const bs = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
        bs.hide();
        alert('Sesión iniciada (demo)');
      });
    });

  </script>
</body>

</html>